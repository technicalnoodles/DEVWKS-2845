<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-xdr-docs/xdr-integration">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Creating a Workflow | DEVWKS-2845</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://galica9999.github.io/DEVWKS-2845/xdr-docs/xdr-integration"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Creating a Workflow | DEVWKS-2845"><meta data-rh="true" name="description" content="When creating a workflow without using the built in Meraki integraiton, we first need to be able to store the API key in a secure way within XDR, then we can use it in the workflow."><meta data-rh="true" property="og:description" content="When creating a workflow without using the built in Meraki integraiton, we first need to be able to store the API key in a secure way within XDR, then we can use it in the workflow."><link data-rh="true" rel="icon" href="/DEVWKS-2845/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://galica9999.github.io/DEVWKS-2845/xdr-docs/xdr-integration"><link data-rh="true" rel="alternate" href="https://galica9999.github.io/DEVWKS-2845/xdr-docs/xdr-integration" hreflang="en"><link data-rh="true" rel="alternate" href="https://galica9999.github.io/DEVWKS-2845/xdr-docs/xdr-integration" hreflang="x-default"><link rel="stylesheet" href="/DEVWKS-2845/assets/css/styles.67b876cf.css">
<link rel="preload" href="/DEVWKS-2845/assets/js/runtime~main.e2d4b742.js" as="script">
<link rel="preload" href="/DEVWKS-2845/assets/js/main.14980a2f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/DEVWKS-2845/"><div class="navbar__logo"><img src="/DEVWKS-2845/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/DEVWKS-2845/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">DEVWKS-2845</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/DEVWKS-2845/intro">Tutorial</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/galica9999/DEVWKS-2845" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/DEVWKS-2845/intro">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/DEVWKS-2845/category/meraki-setup">Meraki Setup</a><button aria-label="Toggle the collapsible sidebar category &#x27;Meraki Setup&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/DEVWKS-2845/category/xdr-workflow">XDR Workflow</a><button aria-label="Toggle the collapsible sidebar category &#x27;XDR Workflow&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/DEVWKS-2845/xdr-docs/xdr-integration">Creating a Workflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DEVWKS-2845/xdr-docs/create-a-trigger">Creating a Trigger and Automation Rule</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/DEVWKS-2845/xdr-docs/update-workflow">Use Webhook Data</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/DEVWKS-2845/testing">Testing The Deployment</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/DEVWKS-2845/category/appendix">Appendix</a><button aria-label="Toggle the collapsible sidebar category &#x27;Appendix&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/DEVWKS-2845/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/DEVWKS-2845/category/xdr-workflow"><span itemprop="name">XDR Workflow</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Creating a Workflow</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Creating a Workflow</h1><p>When creating a workflow without using the built in Meraki integraiton, we first need to be able to store the API key in a secure way within XDR, then we can use it in the workflow.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-secure-workflow-variable">Create a Secure Workflow Variable<a href="#create-a-secure-workflow-variable" class="hash-link" aria-label="Direct link to Create a Secure Workflow Variable" title="Direct link to Create a Secure Workflow Variable">​</a></h2><ol><li><p>After logging into XDR, go to <strong>Automate -&gt; Variables</strong>
<img loading="lazy" alt="variables" src="/DEVWKS-2845/assets/images/variables-7f4a5afdd60da13a1cceb456cea23a6e.png" width="738" height="924" class="img_ev3q"></p></li><li><p>Then click on the <strong>+ Nwew Variable</strong> button on the right side to create a new variables
<img loading="lazy" alt="variables" src="/DEVWKS-2845/assets/images/new-variable-5850df577025d063d4779753610434db.png" width="3202" height="810" class="img_ev3q"></p></li><li><p>In the fields of the new variable change them as follows:</p></li></ol><ul><li><p><strong>Data Type</strong> -&gt; <em>Secure String</em></p></li><li><p><strong>Display Name</strong> -&gt; <em>[stationNumber]<!-- -->MerakiKey</em></p></li><li><p><strong>Scope</strong> -&gt; Environment</p></li><li><p><strong>Value</strong> -&gt; meraki api key from earlier</p><p>It should look similar to the below:
<img loading="lazy" alt="variable filled" src="/DEVWKS-2845/assets/images/variable-filled-f95ba025b44620a9a58c8d6409b608cb.png" width="1780" height="1434" class="img_ev3q"></p></li></ul><ol start="4"><li><p>Click <strong>Save</strong> on the bottom right.</p><p><img loading="lazy" alt="save button" src="/DEVWKS-2845/assets/images/save-bac410e710ebe2a192d28b8b4d9433dc.png" width="568" height="324" class="img_ev3q"></p></li></ol><p>Now we can work on making the workflow</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-workflow">Create a Workflow<a href="#create-a-workflow" class="hash-link" aria-label="Direct link to Create a Workflow" title="Direct link to Create a Workflow">​</a></h2><p>To create a workflow, we first need to to go to the workflow editor. Then we can create our workflow.</p><ol><li>Go to <strong>Automate -&gt; Worflows</strong><img loading="lazy" alt="workflows" src="/DEVWKS-2845/assets/images/workflows-page-d3f0a22dbc4ed7fbba691151c19e85eb.png" width="728" height="998" class="img_ev3q"></li><li>Click on <strong>Create Workflow</strong> on the far right of the screen.
<img loading="lazy" alt="create workflow" src="/DEVWKS-2845/assets/images/create-workflow-065302d3335d20bdebfe0af696573f3d.png" width="3190" height="666" class="img_ev3q"></li><li>Leave the <strong>Blank Custom Workflow</strong> selected and click on <!-- -->*<!-- -->*<!-- -->Continue on the bottom right of the pop up.
<img loading="lazy" alt="blank workflow" src="/DEVWKS-2845/assets/images/blank-workflow-8a60dc697f2a7c94afb920896ed7aa91.png" width="1756" height="1240" class="img_ev3q"></li><li>Now we can name the workflow. Please use your workstation ID followed by MerakiWF. It should look like the below example:
<img loading="lazy" alt="name workflow" src="/DEVWKS-2845/assets/images/name-workflow-31052efa7f9929173dbe1c0840dd10c4.png" width="1100" height="758" class="img_ev3q"></li><li>This bring you to a blank workflow like the below:
<img loading="lazy" alt="blank workflow editor" src="/DEVWKS-2845/assets/images/blank-workflow-editor-0eaec299c41f52d15cacae3ab2952798.png" width="3454" height="1500" class="img_ev3q"></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jsonpath-query">JSONPath Query<a href="#jsonpath-query" class="hash-link" aria-label="Direct link to JSONPath Query" title="Direct link to JSONPath Query">​</a></h3><ol><li>We need to first be able to read data from the webhook when Meraki sends it. To do this, we can search for <em>JSONPath</em> in the top left search bar. It should return a <strong>JSONPath Query</strong>. Click and drag it into the workflow editor area. It should look like the below:
<img loading="lazy" alt="blank workflow editor" src="/DEVWKS-2845/assets/images/json-path-query-e10d083e9ab27f3586219adb5111c49e.png" width="2144" height="1104" class="img_ev3q"></li><li>We will be changing the data being fed into the <strong>JSONPath Query</strong> later, but for now, we need some dummy data to make sure the workflow is valid. Take the below JSON and paste it into <strong>Source JSON to Query</strong> box on the right side.</li></ol><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;version&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0.1&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;sharedSecret&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;sentAt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2023-01-13T19:57:07.307562Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;organizationId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;000000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;organizationName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;EX net&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;organizationUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://n471.meraki.com/o/000000/manage/organization/overview&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;networkId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;N_00000000&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;networkName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Ex net&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;networkUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://n471.meraki.com/ex_net/n/000000/manage/nodes/wired_status&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;networkTags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;deviceSerial&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Q00Y-U00R-T00G&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;deviceMac&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;00:00:00:d7:14:83&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;deviceName&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Home MX&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;deviceUrl&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;https://n471.meraki.com/ex_net/n/000000/manage/nodes/new_wired_status&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;deviceTags&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;deviceModel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MX67W&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;alertId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;alertType&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Switch port disconnected&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;alertTypeId&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;port_disconnected&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;alertLevel&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;warning&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;occurredAt&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;2023-01-13T19:57:07.259607Z&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">&quot;alertData&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;portNum&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;description&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Switch port is down&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;status&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;down&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;prevStatus&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;100 Gbps&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">&quot;portDesc&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Corp Access&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It should look like the below now:
<img loading="lazy" alt="blank workflow editor" src="/DEVWKS-2845/assets/images/paste-json-ef361a6ac57e0bcda69f728cd20b6420.png" width="1354" height="1734" class="img_ev3q"></p><ol start="3"><li><p>Now we need to create 4 <strong>JSONPath Queries</strong>
<img loading="lazy" alt="blank queries" src="/DEVWKS-2845/assets/images/blank-queries-ef98b5b9c40fae3e335d80d37631bbd0.png" width="846" height="346" class="img_ev3q"></p></li><li><p>The first query will be to get the devices serial number. Click on <strong>+ Add</strong>, then fill in the 3 fields like the below:</p></li></ol><ul><li>JSONPath Query -&gt; $.deviceSerial</li><li>Property Name -&gt; deviceSerial</li><li>Property Type -&gt; String
<img loading="lazy" alt="serial query" src="/DEVWKS-2845/assets/images/device-serial-4e33f6824a0a2a712aa5003d4123f591.png" width="1334" height="580" class="img_ev3q"></li></ul><ol start="5"><li><p>We will repeat this 3 more times for these queries:</p><table><thead><tr><th>JSONPath Query</th><th>Property Name</th><th>Property Type</th></tr></thead><tbody><tr><td>$.alertTypeId</td><td>alertType</td><td>String</td></tr><tr><td>$.alertData.status</td><td>portStatus</td><td>String</td></tr><tr><td>$.alertData.portNum</td><td>portNum</td><td>String</td></tr></tbody></table><p><img loading="lazy" alt="all queries" src="/DEVWKS-2845/assets/images/all-queries-11bec740477bffc35819f3853606686c.png" width="1338" height="1634" class="img_ev3q"></p></li><li><p>Now we need to check the box <strong>Continue Workflow Execution On Failure</strong>
<img loading="lazy" alt="continue" src="/DEVWKS-2845/assets/images/continue-workflow-b5fc0f0120c221d5bbfb9a8115d8e992.png" width="908" height="1010" class="img_ev3q">
With this done, we can now pass this data to other parts of our workflow.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="condition-block">Condition Block<a href="#condition-block" class="hash-link" aria-label="Direct link to Condition Block" title="Direct link to Condition Block">​</a></h3><ol><li><p>We need to check that we got the right type of alert from the webhook and that we got a specific port status. To do that, we can add a <strong>Condition Block</strong>. We can search for <em>condition</em> in the top left search box and then drag the <strong>Condition Block</strong> item into the editor below the JSONPath Query.
<img loading="lazy" alt="condition block" src="/DEVWKS-2845/assets/images/condition-block-aad73bc83187e77f90e4810f7064fc40.png" width="2462" height="1334" class="img_ev3q"></p></li><li><p>Delete the second <strong>Condition Branch</strong> by clicking on the 3 dots on the top right of it and selecting <strong>Delete</strong>
<img loading="lazy" alt="branch delete" src="/DEVWKS-2845/assets/images/branch-delete-c1de3494720c80676c0f683b0a37e23b.png" width="388" height="294" class="img_ev3q">
Now we should have something similar to the below:
<img loading="lazy" alt="single branch" src="/DEVWKS-2845/assets/images/single-condition-85ec8b0b46ccd57ba184e0821b672f92.png" width="836" height="1062" class="img_ev3q"></p></li><li><p>Click on the one condition block that is left and click on the <strong>Condition</strong> drop down to expand it.</p></li><li><p>We are going to create two conditions we want to check. Thr first is to check for the type of alert we received. To do that we can select the small browser window icon in the <strong>Property</strong> text box. Then go to <strong>Activities -&gt; JSONPath Query -&gt; Jsonpath Queries -&gt; alertType</strong>. Click on <strong>Save</strong>
<img loading="lazy" alt="alerttype" src="/DEVWKS-2845/assets/images/select-alert-type-ed64bc00d9407816e03a009365aa604c.png" width="1470" height="1232" class="img_ev3q"></p></li><li><p>Now we can set the value to <em>port_disconnected</em> by typing it into the <strong>Value</strong> field. The condition should look like the below.
<img loading="lazy" alt="alerttype" src="/DEVWKS-2845/assets/images/condition-1-b84d450c457dcdcc0bc2cc4e81a2f713.png" width="776" height="514" class="img_ev3q"></p></li><li><p>Now we can create the second condition. We want to set the <strong>Property</strong> field to portStatus using the selector from before. And set the <strong>Value</strong> to <em>down</em>. It should look similar to the below image:
<img loading="lazy" alt="alerttype" src="/DEVWKS-2845/assets/images/condition-2-8a358b341024de0c6f73df05aa2a9b6a.png" width="782" height="524" class="img_ev3q"></p></li></ol><p>These are all the conditions we need to look for. Now we want to add what action we will take in the workflow when the condition is true.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="http-request">HTTP Request<a href="#http-request" class="hash-link" aria-label="Direct link to HTTP Request" title="Direct link to HTTP Request">​</a></h3><ol><li><p>Search for <em>http</em> in the left search box and drag the <strong>HTTP Request</strong> item into the condition block.
<img loading="lazy" alt="http request" src="/DEVWKS-2845/assets/images/http-request-6776cd92924b85416b83f0b5af485379.png" width="3422" height="1500" class="img_ev3q"></p></li><li><p>Click the <strong>Target</strong> dropdown on the right side to expand its options. Then click on <strong>override workflow target</strong>
<img loading="lazy" alt="http request" src="/DEVWKS-2845/assets/images/override-target-a4077a2fa8894faa0e4a7ab0f6b4274f.png" width="1348" height="528" class="img_ev3q"></p></li><li><p>Click into the <strong>Target</strong> field and click on <strong>+ Add New</strong>
<img loading="lazy" alt="http request" src="/DEVWKS-2845/assets/images/add-new-target-5cd913806cc3d2c58ad467995b1bed32.png" width="1320" height="858" class="img_ev3q"></p></li><li><p>Set the fields like the below:</p></li></ol><ul><li><p>Display Name -&gt; <!-- -->[stationID]<!-- -->MerakiApi</p></li><li><p>No Account Keys -&gt; true</p></li><li><p>Protocol -&gt; https</p></li><li><p>Host/IPAddress -&gt; api.meraki.com</p><p>It should look similar to the below image:
<img loading="lazy" alt="http request" src="/DEVWKS-2845/assets/images/target-settings-d8c6ae7669ff7287e44429395d63d6e8.png" width="778" height="1604" class="img_ev3q"></p></li></ul><ol start="5"><li><p>Click <strong>Save</strong></p></li><li><p>Expand the <strong>HTTP Request</strong> section</p></li><li><p>In the <strong>Relative URL</strong> field, type in <em>/api/v1/devices/</em></p></li><li><p>Click on the small selector we have used before and pick the <strong>deviceSerial</strong> variable.</p></li><li><p>Continue typing after the device serial is filled in with this: <em>/switch/ports/</em></p></li><li><p>Click on the selector and select the <strong>portNum</strong> variable. The URL should look similar to the below:
<img loading="lazy" alt="http request" src="/DEVWKS-2845/assets/images/relative-url-44b165384ee40146e2112b33af586ae7.png" width="1288" height="238" class="img_ev3q"></p></li><li><p>Now change the <strong>Method</strong> to <strong>PUT</strong></p></li><li><p>In the <strong>Request Body</strong> paste in the below JSON:</p></li></ol><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">&quot;enabled&quot;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The <strong>HTTP Request</strong> section should look like the below:
<img loading="lazy" alt="http request" src="/DEVWKS-2845/assets/images/http-request-final-c144a5ed789dad98fe859b5dea4a72af.png" width="1310" height="790" class="img_ev3q"></p><ol start="13"><li><p>Expand the <strong>Headers</strong> section</p></li><li><p>Change the <strong>Content Type</strong> field to <strong>Application JSON</strong></p></li><li><p>Put <em>application/json</em> into the <strong>Accept</strong> field</p></li><li><p>Now we need to add some custom headers. Under <strong>Header</strong> press the <strong>+ Add</strong> to add a new field.</p></li><li><p>In the new field put <em>X-Cisco-Meraki-API-Key</em> in the <strong>Header</strong> field.</p></li><li><p>In the <strong>Value</strong> field, click on the selector button then select <strong>Env -&gt; yourMerakiKey</strong>. Click <strong>Save</strong>
<img loading="lazy" alt="http request" src="/DEVWKS-2845/assets/images/env-meraki-key-41115a06b172b5df1894d493cadc60ce.png" width="1318" height="1086" class="img_ev3q"></p></li><li><p>Lastly, click on <strong>Validate</strong> on the top right</p></li></ol><p>This concludes the workflow work until we have made a trigger and an Automation Rule to pass the webhook data to the workflow.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://cisco.com/docs/xdr-docs/01-xdr-integration.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/DEVWKS-2845/category/xdr-workflow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">XDR Workflow</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/DEVWKS-2845/xdr-docs/create-a-trigger"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Creating a Trigger and Automation Rule</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-a-secure-workflow-variable" class="table-of-contents__link toc-highlight">Create a Secure Workflow Variable</a></li><li><a href="#create-a-workflow" class="table-of-contents__link toc-highlight">Create a Workflow</a><ul><li><a href="#jsonpath-query" class="table-of-contents__link toc-highlight">JSONPath Query</a></li><li><a href="#condition-block" class="table-of-contents__link toc-highlight">Condition Block</a></li><li><a href="#http-request" class="table-of-contents__link toc-highlight">HTTP Request</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/galica9999/DEVWKS-2845" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Cisco DEVWKS-2845</div></div></div></footer></div>
<script src="/DEVWKS-2845/assets/js/runtime~main.e2d4b742.js"></script>
<script src="/DEVWKS-2845/assets/js/main.14980a2f.js"></script>
</body>
</html>